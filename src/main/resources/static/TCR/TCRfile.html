<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Model Test</title>

    <link rel="stylesheet" href="/src/menu.css" />
    <link href="/src/server.css" rel="stylesheet" type="text/css">
    <link href="/src/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="/src/Lbackground.css">
    <link rel="stylesheet" href="/src/Rbackground.css">
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>


    <style>
        .squares
        {
            position:absolute;
        }
    </style>


</head>


<body>

<!--原来的背景-->
<canvas id="canvas"></canvas>

<!--动态背景（左）-->
<div class='squares'>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
    <div class='square'></div>
</div>

<!--动态背景（右）-->
<div class='Rsquares'>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
    <div class='Rsquare'></div>
</div>



<div class="body_content">

    <br><br/><br><br/>
    <div id="header">
        <h1><a class="red" href="/index.html">ImmunoFlash Sever</a></h1>
        <ul id="menu">
            <li><a href="/index.html" title="DLpTCR Server">首页</a></li>
            <li><a href="/Home.html" title="Home">Home</a></li>
            <li class="active"><a href="/Server.html" title="DLpTCR Server">Web Server</a></li>
            <li><a href="/Download.html" title="Download">Download</a></li>
            <li><a href="/Example.html" title="Example">Example</a></li>

            <li><a href="/Citation.html" title="Citation">Citation</a></li>
            <!--<li><a href="./tutorial" title="Tutorial">Tutorial</a></li>-->
        </ul>
    </div>



    <br><br/><br><br/>
    <br><br/><br><br/>



    <div id="canshu" style="width: 900px; " >
        <!--      下边的action属性指定表单数据提交的目标地址，由后端的注解方法来处理-->
        <form action="/submitForm" enctype='multipart/form-data' method='POST' >

            <div class="col">

                <h3><span class="red">Input File(文件上传)</span></h3>


                <b>
                    <label>Microsoft Excel Format (.csv):</label>
                </b>
                <br><br/>

                <input class="file" type="file" name="file" id="file" accept=".csv" required>
                <br><br/>

                <div class="info1">
                    <!--          示例文档链接-->
                    <b>

                        <!--            <a href="/static/examples/independent_set.csv">Example File</a>-->
                        <a href="/Example.html">Example File（上传的示例文件）</a>
                    </b>
                    <br><br/>
                </div>

            </div>





            <div class="col">

                <h3><span class="red">Job Submission</span></h3>


                <br><br/>
                <b><label>&ensp;&ensp;Email:</label></b>
                <!--          先不写required,先进行测试-->
                <!--        <input type = "text"  id="Email_address" name="Email_address"  size="25" placeholder= 'Please enter your email address' required>-->
                <input type = "text"  id="Email_address" name="Email_address"  size="25" placeholder= 'Please enter your email address' required >
                <br><br/>


                <label>&ensp;&ensp;
                    <input type="checkbox" name="checkbox"> 是否需要热图
                </label>


            </div>


            <div align="center" class="col1">
                <!--                <span><a href="#"></a></span>-->
                <span id="submitFormButton" ><a href="#"></a></span>

            </div>


        </form>
    </div>

    <br><br/><br><br/>
    <div id="footer" class = "beian">

        <p align="center">Jiang Lab:Bioinformatic Team (<a href="http://www.jianglab.org.cn/">Jiang Lab</a>)
            ----------------------------------------------------Contact: qhjiang@hit.edu.cn</p>
        <p align="center"><a href="http://www.beian.miit.gov.cn/">赣ICP备20010039号</a></p>

    </div>

</div>



<!--<canvas id="canvas"></canvas>-->
<script src="/src/index.js"></script>



<script>

    // 监听按钮点击事件
    $("#submitFormButton").on("click", function () {

        // 检查表单的有效性
        var isFormValid = $("form")[0].checkValidity();
        if (!isFormValid) {
            // 如果表单验证不通过，则显示提示信息
            alert("Please fill in all the information completely.");
            return;
        }




        //文件上传逻辑
        var fileObj = document.getElementById("file").files[0];//这边的file是输入框上传的文件数据
        var form = new FormData();
        form.append("file", fileObj);

        // 使用Ajax发送文件到服务器
        $.ajax({
            type: "POST",
            url: "/uploadTCR",  // 指定服务器端点（文件上传）
            data: form,
            processData: false,
            contentType: false,
            success: function (data) {
                // 处理成功，可以显示消息或执行其他操作
                alert(data);
                window.location.href = window.location.href;
            },
            error: function () {
                // 处理错误，如果有的话
                alert("请上传文件.");
            }
        });





        // 如果表单验证通过，则提交表单
        $("form").submit();
    });


    // 在表单提交成功后，显示邮件发送结果
    $("form").submit(function (event) {
        event.preventDefault(); // 阻止表单的默认提交行为
        var formData = $(this).serialize(); // 将表单数据序列化为字符串

        $.ajax({
            type: "POST",
            url: "/submitFormTCRfile", // 提交到后端处理邮件发送的接口
            data: formData,
            success: function (data) {
                // 处理成功，显示邮件发送结果
                alert(data);
            },
            error: function () {
                // 处理错误
                alert("邮件发送失败，请检查邮箱是否书写正确。");
            }
        });
    });
</script>


</body>
</html>